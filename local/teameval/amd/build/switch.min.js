define(["jquery"],function(a){function b(b){var c=a("#"+b.data("override"));c&&c.trigger("setState",[null,"break"])}function c(a,b){var c=a.attr("id");if(void 0!==d[c])for(var e=0;e<d[c].length;e++){var f=d[c][e];f.trigger("setState",[b,"override"])}}var d={};return{init:function(e){e=a(e);var f=a(e).hasClass("tristate"),g=e.data("override");void 0!==g&&(void 0===d[g]&&(d[g]=[]),d[g].push(e)),e.html('<div class="toggle"><svg class="loading-indicator" xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 1 1">    <g fill="black">       <rect x="0.45" y="0" width="0.1" height="0.37" rx="0.05" ry="0.05" />       <rect x="0.45" y="0" width="0.1" height="0.37" rx="0.05" ry="0.05"            transform="rotate(-45 0.5 0.5)"  style="opacity: 1.0"/>       <rect x="0.45" y="0" width="0.1" height="0.37" rx="0.05" ry="0.05"            transform="rotate(-90 0.5 0.5)"  style="opacity: 0.9"/>       <rect x="0.45" y="0" width="0.1" height="0.37" rx="0.05" ry="0.05"            transform="rotate(-135 0.5 0.5)" style="opacity: 0.8" />       <rect x="0.45" y="0" width="0.1" height="0.37" rx="0.05" ry="0.05"            transform="rotate(-180 0.5 0.5)" style="opacity: 0.7" />       <rect x="0.45" y="0" width="0.1" height="0.37" rx="0.05" ry="0.05"            transform="rotate(-225 0.5 0.5)" style="opacity: 0.6" />       <rect x="0.45" y="0" width="0.1" height="0.37" rx="0.05" ry="0.05"            transform="rotate(-270 0.5 0.5)" style="opacity: 0.5" />       <rect x="0.45" y="0" width="0.1" height="0.37" rx="0.05" ry="0.05"            transform="rotate(-315 0.5 0.5)" style="opacity: 0.4" />       <animateTransform attributeName="transform" attributeType="XML"            type="rotate" from="0 0.5 0.5" to="360 0.5 0.5" dur="1.5s" repeatCount="indefinite"/>    </g></svg></div>'),f&&(e.append('<svg class="reject" height="8" viewBox="0 0 10 10"><path d="M 1 1 L 8 8 M 1 8 L 8 1" /></svg>'),e.append('<svg class="check" viewBox="0 0 10 10"><path d="M 1 6 L 4 8 L 8 1" fill="none" /></svg>'));var h=e.data("state");h&&e.addClass(h),e.attr({"aria-role":"checkbox","aria-checked":e.hasClass("checked")?"true":"false"}),e.on("click",function(b){var c;if(f)if(e.hasClass("rejected")||e.hasClass("checked"))e.trigger("setState",[null,"user"]);else{var d=a(b.target);if(d.hasClass("toggle"))return;var g=b.pageX-e.offset().left;c=g<e.width()/2?"rejected":"checked",e.trigger("setState",[c,"user"])}else c=e.hasClass("checked")?null:"checked",e.trigger("setState",[c,"user"])}),e.on("showLoading",function(){e.find(".loading-indicator").show()}),e.on("hideLoading",function(){e.find(".loading-indicator").hide()}),e.on("setState",function(a,d,f){var g=e.data("state");e.removeClass("rejected"),e.removeClass("checked"),d?(e.addClass(d),e.attr("aria-checked","checked"==d?"true":"false")):e.attr("aria-checked","mixed"),e.data("state",d),"auto"!=f&&g!=d&&e.trigger("changed"),"user"==f&&(b(e),c(e,d)),"break"==f&&b(e),"override"==f&&c(e,d)})},resolveStates:function(){var b=!1;a.each(d,function(c,e){for(var f=e[0].data("state"),g=e.length-1;g>=0;g--){var h=e[g];h.data("state")!=f&&(f=null)}var i=a("#"+c);if(0===i.length)return void delete d[c];var j=i.data("state");if(j!=f){i.trigger("setState",[f,"auto"]);var k=i.data("state");if(k!=f)return window.console.log("Update state failed!"),!1;b=!0}}),b&&this.resolveStates()}}});